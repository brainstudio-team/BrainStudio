__version__ = 0.001
__abstract__ = False

from BrainStdBECore.Node import Node as Node
from BrainStdBECore.BSException import BSException as BSException
import numpy as np


class BrainStdBEClass(Node) :
    


    def __init__(self) :
        super(BrainStdBEClass,self).__init__()
        self.configurations['RateLayer'] = ([], [], [], []) 
        self.fields.append(['neurons', 'Number of neurons','integer', '1', ''])
        self.input_field = 'neurons'
        self.output_field = 'neurons'
        self.units_field = 'neurons'
        self.size = -1
        
    def get_version(self):
        return __version__
        
    def get_input_size(self):
        return self.size
    
    def get_output_size(self):
        return self.size
        
    def get_start_neuron(self):
        return 0
        
    def get_all_data(self):
        return list(self.outputs)
        
    def get_data(self, args):
        first_neuron = args['first_neuron']
        last = args['last']
        outputs = self.outputs[first_neuron: last+1]            
        return outputs
        
    def set_data(self, args):
        inputs = args['inputs']
        first_neuron = args['first_neuron']
        last = args['last']
        for n in range(first_neuron, last+1):
            self.inputs[n] += inputs[n-first_neuron]
        
    def initialize(self, brain, node, args):
        self.size = self.safely_get(node, 'neurons', 'int')   
        self.inputs = np.zeros(self.size)
        self.outputs = np.zeros(self.size)
        
        return self.size
            
    def update(self):
        self.inputs - np.zeros(self.size)
        args = dict()
        for s in self.sources:
            s.get_data(args)
        self.outputs = np.tanh(self.inputs)
        
